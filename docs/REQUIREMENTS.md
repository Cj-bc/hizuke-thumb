# ã²ã¥ã‘ã‚µãƒ ãƒ (hizuke-thumb) è¦ä»¶å®šç¾©æ›¸

## ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [æ©Ÿèƒ½è¦ä»¶](#2-æ©Ÿèƒ½è¦ä»¶)
3. [éæ©Ÿèƒ½è¦ä»¶](#3-éæ©Ÿèƒ½è¦ä»¶)
4. [UI/UXè¦ä»¶](#4-uiuxè¦ä»¶)
5. [å°†æ¥ã®æ‹¡å¼µæ€§ã¸ã®é…æ…®](#5-å°†æ¥ã®æ‹¡å¼µæ€§ã¸ã®é…æ…®)
6. [é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](#6-é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—)
7. [æŠ€è¡“ä»•æ§˜è©³ç´°](#7-æŠ€è¡“ä»•æ§˜è©³ç´°)

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ç›®çš„

ã€Œã²ã¥ã‘ã‚µãƒ ãƒã€ã¯ã€é…ä¿¡ã‚„å‹•ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ä½œæˆã«ãŠã„ã¦ã€ãƒ™ãƒ¼ã‚¹ç”»åƒã«æ—¥ä»˜ã‚„æ›œæ—¥ãªã©ã®å¯å¤‰è¦ç´ ã‚’è¿½åŠ ã™ã‚‹ä½œæ¥­ã‚’åŠ¹ç‡åŒ–ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

### 1.2 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **è¨€èª**: TypeScript
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Svelte 5.x (Runes APIä½¿ç”¨)
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼**: Bun
- **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«**: Vite 7.x
- **çŠ¶æ…‹ç®¡ç†**: Svelte 5 Runes ($state, $derivedç­‰)
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: TailwindCSS 4.x
- **ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–**: IndexedDB (Dexie.js 4.x)
- **PWAå¯¾å¿œ**: vite-plugin-pwa 1.x
- **ãƒ†ã‚¹ãƒˆ**: Vitest 4.x
- **å‹•ä½œç’°å¢ƒ**: ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆChrome, Firefox, Safari, Edgeï¼‰

### 1.3 é–‹ç™ºç’°å¢ƒè¦ä»¶

- **Bun**: 1.0ä»¥ä¸Š
- **æ¨å¥¨OS**: macOS, Linux (Windows: WSL2æ¨å¥¨)
- **Node.js**: ä¸è¦ï¼ˆBunãŒä»£æ›¿ï¼‰

### 1.4 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
hizuke-thumb/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ manifest.json
â”‚   â””â”€â”€ icons/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ canvas/
â”‚   â”‚   â”‚   â”œâ”€â”€ CanvasEngine.ts        # Canvasæç”»ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”‚   â”‚   â”œâ”€â”€ TextRenderer.ts        # ãƒ†ã‚­ã‚¹ãƒˆæç”»
â”‚   â”‚   â”‚   â””â”€â”€ ImageLoader.ts         # ç”»åƒèª­ã¿è¾¼ã¿
â”‚   â”‚   â”œâ”€â”€ layers/
â”‚   â”‚   â”‚   â”œâ”€â”€ LayerManager.svelte.ts # ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†ï¼ˆRunesä½¿ç”¨ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ LayerTransform.ts      # ä½ç½®ãƒ»å¤‰å½¢è¨ˆç®—
â”‚   â”‚   â”œâ”€â”€ storage/
â”‚   â”‚   â”‚   â”œâ”€â”€ indexeddb.ts           # IndexedDB ãƒ©ãƒƒãƒ‘ãƒ¼ï¼ˆDexie.jsä½¿ç”¨ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ presets.ts             # ãƒ—ãƒªã‚»ãƒƒãƒˆæ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ assets.ts              # ç”»åƒãƒ»ãƒ•ã‚©ãƒ³ãƒˆç®¡ç†
â”‚   â”‚   â”œâ”€â”€ state/
â”‚   â”‚   â”‚   â”œâ”€â”€ preset.svelte.ts       # ãƒ—ãƒªã‚»ãƒƒãƒˆçŠ¶æ…‹ï¼ˆRunesï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ layers.svelte.ts       # ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ï¼ˆRunesï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ canvas.svelte.ts       # CanvasçŠ¶æ…‹ï¼ˆRunesï¼‰
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ dateFormatter.ts       # æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ fileHandler.ts         # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ shortcuts.ts           # ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â”œâ”€â”€ preset.ts              # ãƒ—ãƒªã‚»ãƒƒãƒˆå‹å®šç¾©
â”‚   â”‚       â”œâ”€â”€ layer.ts               # ãƒ¬ã‚¤ãƒ¤ãƒ¼å‹å®šç¾©
â”‚   â”‚       â”œâ”€â”€ canvas.ts              # Canvaså‹å®šç¾©
â”‚   â”‚       â””â”€â”€ index.ts               # å‹ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ +page.svelte               # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ canvas/
â”‚   â”‚   â”‚   â”œâ”€â”€ CanvasEditor.svelte    # Canvasç·¨é›†ã‚¨ãƒªã‚¢
â”‚   â”‚   â”‚   â”œâ”€â”€ CanvasPreview.svelte   # ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ CanvasToolbar.svelte   # ãƒ„ãƒ¼ãƒ«ãƒãƒ¼
â”‚   â”‚   â”œâ”€â”€ properties/
â”‚   â”‚   â”‚   â”œâ”€â”€ PropertiesPanel.svelte # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ‘ãƒãƒ«ï¼ˆå³ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageProperties.svelte # ç”»åƒãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
â”‚   â”‚   â”‚   â”œâ”€â”€ TextProperties.svelte  # ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
â”‚   â”‚   â”‚   â””â”€â”€ LayerPanel.svelte      # ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‘ãƒãƒ«ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ä¸‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ layers/
â”‚   â”‚   â”‚   â””â”€â”€ LayerItem.svelte       # ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ presets/
â”‚   â”‚   â”‚   â”œâ”€â”€ PresetSelector.svelte  # ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠ
â”‚   â”‚   â”‚   â”œâ”€â”€ PresetCard.svelte      # ãƒ—ãƒªã‚»ãƒƒãƒˆã‚«ãƒ¼ãƒ‰
â”‚   â”‚   â”‚   â”œâ”€â”€ PresetSaveDialog.svelte# ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”‚   â”‚   â””â”€â”€ PresetManager.svelte   # ãƒ—ãƒªã‚»ãƒƒãƒˆç®¡ç†
â”‚   â”‚   â”œâ”€â”€ generation/
â”‚   â”‚   â”‚   â”œâ”€â”€ DatePicker.svelte      # æ—¥ä»˜é¸æŠï¼ˆå˜ä¸€ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ DateRangePicker.svelte # æ—¥ä»˜ç¯„å›²é¸æŠï¼ˆè¤‡æ•°ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ GenerationPreview.svelte # ç”Ÿæˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
â”‚   â”‚   â”‚   â””â”€â”€ GenerationDialog.svelte  # ç”Ÿæˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ Modal.svelte
â”‚   â”‚   â”‚   â”œâ”€â”€ ColorPicker.svelte
â”‚   â”‚   â”‚   â””â”€â”€ Dropdown.svelte
â”‚   â”‚   â””â”€â”€ layout/
â”‚   â”‚       â”œâ”€â”€ Header.svelte
â”‚   â”‚       â””â”€â”€ MainLayout.svelte
â”‚   â”œâ”€â”€ workers/
â”‚   â”‚   â””â”€â”€ image-processor.ts         # Web Workerï¼ˆç”»åƒå‡¦ç†ï¼‰
â”‚   â”œâ”€â”€ app.html
â”‚   â”œâ”€â”€ app.css
â”‚   â””â”€â”€ main.ts
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â””â”€â”€ integration/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml                      # GitHub Actions (Bunä½¿ç”¨)
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ svelte.config.js
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ bunfig.toml                         # Bunè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
â”œâ”€â”€ bun.lockb                           # Bunãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## 2. æ©Ÿèƒ½è¦ä»¶

### 2.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†

#### 2.1.1 ãƒ—ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½

- è¤‡æ•°ã®ãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰ã‚’ä½œæˆãƒ»ç®¡ç†å¯èƒ½
- å„ãƒ—ãƒªã‚»ãƒƒãƒˆã¯ç‹¬ç«‹ã—ã¦ä»¥ä¸‹ã‚’ä¿æŒï¼š
  - ãƒ—ãƒªã‚»ãƒƒãƒˆåï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¿å­˜æ™‚ã«æŒ‡å®šï¼‰
  - ãƒ™ãƒ¼ã‚¹ç”»åƒï¼ˆãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ï¼‰
  - ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆï¼ˆç”»åƒãƒ»ãƒ†ã‚­ã‚¹ãƒˆï¼‰
  - ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ï¼‰
  - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š
  - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆä½œæˆæ—¥æ™‚ã€æœ€çµ‚æ›´æ–°æ—¥æ™‚ï¼‰
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå**: ãƒ—ãƒªã‚»ãƒƒãƒˆæœªä¿å­˜æ™‚ã¯ãƒ™ãƒ¼ã‚¹ç”»åƒã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä½¿ç”¨
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆã®è¨­å®šãŒå¯èƒ½
- èµ·å‹•æ™‚ã¯è‡ªå‹•çš„ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿

#### 2.1.2 ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜ãƒ•ãƒ­ãƒ¼

**åˆå›ä½œæˆæ™‚**:
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ™ãƒ¼ã‚¹ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
2. è‡ªå‹•çš„ã«æ–°ã—ã„ãƒ—ãƒªã‚»ãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹ï¼ˆåå‰ã¯ãƒ™ãƒ¼ã‚¹ç”»åƒã®ãƒ•ã‚¡ã‚¤ãƒ«åï¼‰
3. IndexedDBã«è‡ªå‹•ä¿å­˜ï¼ˆå¤‰æ›´ã®åº¦ã«ï¼‰
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€ã‚’é¸æŠã™ã‚‹ã¨ã€ãƒ—ãƒªã‚»ãƒƒãƒˆåå…¥åŠ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤º
5. ãƒ—ãƒªã‚»ãƒƒãƒˆåã‚’å…¥åŠ›ã—ã¦ä¿å­˜

**ç·¨é›†ä¸­**:
- å¤‰æ›´ã¯è‡ªå‹•çš„ã«IndexedDBã«ä¿å­˜ï¼ˆAuto-saveï¼‰
- ãƒ˜ãƒƒãƒ€ãƒ¼ã«ä¿å­˜ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºï¼ˆã€Œä¿å­˜æ¸ˆã¿ã€ã€Œä¿å­˜ä¸­...ã€ï¼‰

**æ˜ç¤ºçš„ãªä¿å­˜**:
- `Ctrl/Cmd + S` ã¾ãŸã¯ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã§ãƒ—ãƒªã‚»ãƒƒãƒˆåå¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
- æ—¢å­˜ã®ãƒ—ãƒªã‚»ãƒƒãƒˆåã‚’å¤‰æ›´å¯èƒ½
- ã€Œåˆ¥åã§ä¿å­˜ã€ã§ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’è¤‡è£½å¯èƒ½

#### 2.1.3 ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠUI

- ãƒ—ãƒªã‚»ãƒƒãƒˆä¸€è¦§ã‚’ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰
- å„ãƒ—ãƒªã‚»ãƒƒãƒˆã«ä»¥ä¸‹ã‚’è¡¨ç¤ºï¼š
  - ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
  - ãƒ—ãƒªã‚»ãƒƒãƒˆå
  - æœ€çµ‚æ›´æ–°æ—¥æ™‚
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒƒã‚¸ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- ãƒ—ãƒªã‚»ãƒƒãƒˆæ“ä½œï¼š
  - é¸æŠï¼ˆèª­ã¿è¾¼ã¿ï¼‰
  - å‰Šé™¤ï¼ˆç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ä»˜ãï¼‰
  - è¤‡è£½
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š/è§£é™¤

#### 2.1.4 ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**:
- ãƒ—ãƒªã‚»ãƒƒãƒˆè¨­å®šã‚’JSONå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- **ç”»åƒã¨ãƒ•ã‚©ãƒ³ãƒˆã¯å«ã‚ãªã„**ï¼ˆãƒ©ã‚¤ã‚»ãƒ³ã‚¹é…æ…®ï¼‰
- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå†…å®¹ï¼š

```typescript
interface PresetExport {
  version: string;           // ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³
  name: string;
  canvas: {
    width: number;
    height: number;
  };
  layers: LayerConfig[];     // ä½ç½®ã€ã‚¹ã‚¿ã‚¤ãƒ«ç­‰ï¼ˆç”»åƒãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰
  requiredAssets: {
    images: string[];        // å¿…è¦ãªç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åãƒªã‚¹ãƒˆ
    fonts: string[];         // å¿…è¦ãªãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«åãƒªã‚¹ãƒˆ
  };
}
```

**ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**:
- JSON ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
- å¿…è¦ãªã‚¢ã‚»ãƒƒãƒˆï¼ˆç”»åƒãƒ»ãƒ•ã‚©ãƒ³ãƒˆï¼‰ã‚’å€‹åˆ¥ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- ã‚¢ã‚»ãƒƒãƒˆãŒæƒã£ãŸã‚‰ãƒ—ãƒªã‚»ãƒƒãƒˆä½œæˆå®Œäº†

---

### 2.2 ã‚­ãƒ£ãƒ³ãƒã‚¹è¨­å®š

#### 2.2.1 ãƒ™ãƒ¼ã‚¹ç”»åƒ

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»»æ„ã®ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- å¯¾å¿œå½¢å¼: PNG, JPEG, WebP
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã®ã‚µã‚¤ã‚ºãŒã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºã¨ãªã‚‹
- ã‚µã‚¤ã‚ºåˆ¶é™: ãªã—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®å‡¦ç†å¯èƒ½ç¯„å›²å†…ï¼‰
- ç”»åƒã¯IndexedDBã«ä¿å­˜

#### 2.2.2 å‡ºåŠ›è¨­å®š

- å‡ºåŠ›è§£åƒåº¦: ãƒ™ãƒ¼ã‚¹ç”»åƒã¨åŒã˜
- å‡ºåŠ›å½¢å¼: PNG
- ãƒ•ã‚¡ã‚¤ãƒ«å: ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `thumbnail_YYYYMMDD.png`
  - å¤‰æ•°ä½¿ç”¨å¯èƒ½: `{date}`, `{preset_name}` ç­‰

---

### 2.3 ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†

#### 2.3.1 ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¿ã‚¤ãƒ—

**ç”»åƒãƒ¬ã‚¤ãƒ¤ãƒ¼**:

```typescript
interface ImageLayer {
  id: string;
  name: string;
  type: 'image';
  imageId: string;           // IndexedDBå†…ã®ç”»åƒID
  position: { x: number; y: number };
  size: { width: number; height: number };
  opacity: number;           // 0-1
  visible: boolean;
  zIndex: number;
  locked: boolean;           // ç·¨é›†ãƒ­ãƒƒã‚¯
}
```

**ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼**:

```typescript
// ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„å‹ï¼ˆåˆ¤åˆ¥å¯èƒ½ãªãƒ¦ãƒ‹ã‚ªãƒ³å‹ï¼‰
type StaticTextContent = {
  type: 'static';
  value: string;
};

type DateTextContent = {
  type: 'date';
  format: string;
  locale: 'ja' | 'en';
};

type TextContent = StaticTextContent | DateTextContent;

interface TextLayer {
  id: string;
  name: string;
  type: 'text';
  content: TextContent;  // åˆ¤åˆ¥å¯èƒ½ãªãƒ¦ãƒ‹ã‚ªãƒ³å‹
  position: { x: number; y: number };
  style: {
    fontId: string;          // IndexedDBå†…ã®ãƒ•ã‚©ãƒ³ãƒˆID
    fontSize: number;
    color: string;           // hex
    lineHeight: number;
    letterSpacing: number;
    align: 'left' | 'center' | 'right';
    verticalAlign: 'top' | 'middle' | 'bottom';
    bold: boolean;
    italic: boolean;
    underline: boolean;
    outline?: {
      enabled: boolean;
      width: number;
      color: string;
    };
    shadow?: {
      enabled: boolean;
      offsetX: number;
      offsetY: number;
      blur: number;
      color: string;
    };
  };
  visible: boolean;
  zIndex: number;
  locked: boolean;
}
```

**ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ã®æ‹¡å¼µæ€§**:

```typescript
// å„ã‚¿ã‚¤ãƒ—ã®ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ï¼ˆå‹å®‰å…¨ï¼‰
const textRenderers = {
  'static': (content: StaticTextContent) => content.value,
  'date': (content: DateTextContent, context: { date: Date }) => 
    formatDate(context.date, content.format, content.locale),
} as const;

// æ±ç”¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°
function renderTextContent(content: TextContent, context: { date: Date }): string {
  switch (content.type) {
    case 'static':
      return textRenderers.static(content);
    case 'date':
      return textRenderers.date(content, context);
  }
}
```

#### 2.3.2 æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆé¸æŠå¼ï¼‰**:

**æ—¥æœ¬èªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**:
- `2024/01/09`
- `2024.01.09`
- `2024-01-09`
- `2024å¹´01æœˆ09æ—¥`
- `1æœˆ9æ—¥`
- `2024/01/09 (ç«)`
- `1/9 (ç«æ›œæ—¥)`

**è‹±èªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**:
- `Jan 9, 2024`
- `January 9, 2024`
- `1/9/2024`
- `Jan 9, 2024 (Tue)`
- `January 9, 2024 (Tuesday)`

**ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ— + è¨€èªé¸æŠï¼‰**:

UIã«ã¯ä»¥ä¸‹ã®2ã¤ã®è¨­å®šé …ç›®ãŒã‚ã‚Šã¾ã™ï¼š
1. **ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªç”±ã«å…¥åŠ›
2. **è¨€èªè¨­å®š**: `æ—¥æœ¬èª` / `è‹±èª` ã‚’é¸æŠï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã€ãƒ­ã‚±ãƒ¼ãƒ«ã¨ã¯ç‹¬ç«‹ï¼‰

```
ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ—ã®æ§‹æ–‡:
yyyy: 4æ¡å¹´ (2024)
yy:   2æ¡å¹´ (24)
MM:   2æ¡æœˆãƒ»ã‚¼ãƒ­åŸ‹ã‚ (01)
M:    æœˆ (1)
dd:   2æ¡æ—¥ãƒ»ã‚¼ãƒ­åŸ‹ã‚ (09)
d:    æ—¥ (9)

# æ›œæ—¥ï¼ˆè¨€èªè¨­å®šã«ä¾å­˜ï¼‰
EEEE: æ›œæ—¥å®Œå…¨å½¢ â†’ æ—¥æœ¬èª: æœˆæ›œæ—¥ / è‹±èª: Monday
EEE:  æ›œæ—¥çŸ­ç¸®å½¢ â†’ æ—¥æœ¬èª: æœˆ / è‹±èª: Mon
E:    æ›œæ—¥1æ–‡å­— â†’ æ—¥æœ¬èª: æœˆ / è‹±èª: M

# ãã®ä»–
MMMM: æœˆåå®Œå…¨å½¢ â†’ æ—¥æœ¬èª: 1æœˆ / è‹±èª: January
MMM:  æœˆåçŸ­ç¸®å½¢ â†’ æ—¥æœ¬èª: 1æœˆ / è‹±èª: Jan
```

**ä½¿ç”¨ä¾‹**:

| ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ–‡å­—åˆ— | è¨€èª | å‡ºåŠ›ä¾‹ |
|------------------|------|--------|
| `yyyy/MM/dd (EEEE)` | æ—¥æœ¬èª | `2024/01/09 (ç«æ›œæ—¥)` |
| `yyyy/MM/dd (EEEE)` | è‹±èª | `2024/01/09 (Tuesday)` |
| `MMMM d, yyyy` | æ—¥æœ¬èª | `1æœˆ 9, 2024` |
| `MMMM d, yyyy` | è‹±èª | `January 9, 2024` |
| `M/d (EEE)` | æ—¥æœ¬èª | `1/9 (ç«)` |
| `M/d (EEE)` | è‹±èª | `1/9 (Tue)` |

**å®Ÿè£…**:

```typescript
// lib/utils/dateFormatter.ts
import { format } from 'date-fns';
import { ja, enUS } from 'date-fns/locale';

const localeMap = {
  'ja': ja,
  'en': enUS
};

export function formatDate(
  date: Date, 
  formatString: string, 
  locale: 'ja' | 'en' = 'ja'
): string {
  return format(date, formatString, { locale: localeMap[locale] });
}
```

#### 2.3.3 ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ

- **è¿½åŠ **: æ–°è¦ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½œæˆï¼ˆç”»åƒ or ãƒ†ã‚­ã‚¹ãƒˆï¼‰
- **å‰Šé™¤**: é¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‰Šé™¤ï¼ˆç¢ºèªã‚ã‚Šï¼‰
- **è¤‡è£½**: é¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚³ãƒ”ãƒ¼
- **ä¸¦ã³æ›¿ãˆ**: Z-order ã®å¤‰æ›´
  - ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
  - ã€Œæœ€å‰é¢ã¸ã€ã€Œæœ€èƒŒé¢ã¸ã€ãƒœã‚¿ãƒ³
  - ã€Œ1ã¤å‰ã¸ã€ã€Œ1ã¤å¾Œã‚ã¸ã€ãƒœã‚¿ãƒ³
- **è¡¨ç¤º/éè¡¨ç¤º**: ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒ
- **ãƒ­ãƒƒã‚¯/ã‚¢ãƒ³ãƒ­ãƒƒã‚¯**: ç·¨é›†é˜²æ­¢
- **å‘½å**: ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯å³ã‚¯ãƒªãƒƒã‚¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ç·¨é›†

#### 2.3.4 ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‘ãƒãƒ«UIï¼ˆå³ã‚µã‚¤ãƒ‰ãƒãƒ¼ä¸‹éƒ¨ï¼‰

**é…ç½®**: 
- å³ã‚µã‚¤ãƒ‰ãƒãƒ¼
- ä¸Šéƒ¨: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ‘ãƒãƒ«
- ä¸‹éƒ¨: ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‘ãƒãƒ«

ã“ã‚Œã¯Photoshop, Illustrator, CLIP STUDIO PAINT, GIMPãªã©ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«æº–æ‹ ã€‚

```svelte
<!-- components/properties/LayerPanel.svelte -->
<script lang="ts">
  import { layerState } from '$lib/state/layers.svelte';
  
  const addImageLayer = () => { /* ... */ };
  const addTextLayer = () => { /* ... */ };
</script>

<div class="layer-panel">
  <div class="layer-panel-header">
    <h3>ãƒ¬ã‚¤ãƒ¤ãƒ¼</h3>
    <div class="actions">
      <button onclick={addImageLayer}>+ ç”»åƒ</button>
      <button onclick={addTextLayer}>+ ãƒ†ã‚­ã‚¹ãƒˆ</button>
    </div>
  </div>
  
  <div class="layer-list">
    {#each layerState.layers as layer (layer.id)}
      <LayerItem
        {layer}
        selected={layerState.selectedLayerId === layer.id}
        onselect={() => layerState.selectedLayerId = layer.id}
        ontoggle={() => toggleVisibility(layer.id)}
        ondelete={() => deleteLayer(layer.id)}
      />
    {/each}
  </div>
</div>
```

å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ã«è¡¨ç¤ºï¼š
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¿ã‚¤ãƒ—ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç”»åƒ/ãƒ†ã‚­ã‚¹ãƒˆï¼‰
- ãƒ¬ã‚¤ãƒ¤ãƒ¼åï¼ˆç·¨é›†å¯èƒ½ï¼‰
- è¡¨ç¤º/éè¡¨ç¤ºã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç›®ã®ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
- ãƒ­ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³
- ã‚µãƒ ãƒã‚¤ãƒ«ï¼ˆå¯èƒ½ã§ã‚ã‚Œã°ï¼‰

---

### 2.4 ãƒ†ã‚­ã‚¹ãƒˆæ©Ÿèƒ½

#### 2.4.1 ãƒ•ã‚©ãƒ³ãƒˆç®¡ç†

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»»æ„ã®ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- å¯¾å¿œå½¢å¼: TTF, OTF, WOFF, WOFF2
- ãƒ•ã‚©ãƒ³ãƒˆã¯IndexedDBã«ä¿å­˜
- ãƒ—ãƒªã‚»ãƒƒãƒˆæ¯ã«è¤‡æ•°ãƒ•ã‚©ãƒ³ãƒˆã‚’ä¿æŒå¯èƒ½
- ãƒ•ã‚©ãƒ³ãƒˆä¸€è¦§UIï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ‘ãƒãƒ«å†…ï¼‰:
  - ãƒ•ã‚©ãƒ³ãƒˆåè¡¨ç¤º
  - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
  - å‰Šé™¤ãƒœã‚¿ãƒ³

#### 2.4.2 ãƒ†ã‚­ã‚¹ãƒˆæ›¸å¼ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ‘ãƒãƒ«ï¼‰

**åŸºæœ¬è¨­å®š**:
- ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼é¸æŠï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼‰
- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºï¼ˆæ•°å€¤å…¥åŠ›ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‰
- æ–‡å­—è‰²ï¼ˆã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ï¼‰
- è¡Œé–“ï¼ˆæ•°å€¤å…¥åŠ›ï¼‰
- æ–‡å­—é–“éš”ï¼ˆæ•°å€¤å…¥åŠ›ï¼‰
- ãƒ†ã‚­ã‚¹ãƒˆæƒãˆï¼ˆå·¦/ä¸­å¤®/å³ï¼‰
- å‚ç›´æƒãˆï¼ˆä¸Š/ä¸­å¤®/ä¸‹ï¼‰

**æ›¸å¼è¨­å®š** (ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹):
- ãƒœãƒ¼ãƒ«ãƒ‰
- ã‚¤ã‚¿ãƒªãƒƒã‚¯
- ã‚¢ãƒ³ãƒ€ãƒ¼ãƒ©ã‚¤ãƒ³

**ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ï¼ˆç¸å–ã‚Šï¼‰**:
- æœ‰åŠ¹/ç„¡åŠ¹ãƒˆã‚°ãƒ«
- å¤ªã•ï¼ˆæ•°å€¤å…¥åŠ›ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‰
- è‰²ï¼ˆã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ï¼‰

**ãƒ‰ãƒ­ãƒƒãƒ—ã‚·ãƒ£ãƒ‰ã‚¦**:
- æœ‰åŠ¹/ç„¡åŠ¹ãƒˆã‚°ãƒ«
- ã‚ªãƒ•ã‚»ãƒƒãƒˆXï¼ˆæ•°å€¤å…¥åŠ›ï¼‰
- ã‚ªãƒ•ã‚»ãƒƒãƒˆYï¼ˆæ•°å€¤å…¥åŠ›ï¼‰
- ã¼ã‹ã—é‡ï¼ˆæ•°å€¤å…¥åŠ›ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‰
- è‰²ï¼ˆã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ï¼‰

---

### 2.5 é…ç½®ãƒ»èª¿æ•´æ©Ÿèƒ½

#### 2.5.1 ç·¨é›†ãƒ¢ãƒ¼ãƒ‰

**æ’ä¹…çš„é…ç½®ãƒ¢ãƒ¼ãƒ‰** (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ):
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é…ç½®ã‚’è¨­å®š
- è¨­å®šã¯ãƒ—ãƒªã‚»ãƒƒãƒˆã«ä¿å­˜ã•ã‚Œã‚‹
- æ“ä½œæ–¹æ³•:
  - **ãƒã‚¦ã‚¹ãƒ‰ãƒ©ãƒƒã‚°**: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç›´æ¥ç§»å‹•
  - **æ•°å€¤å…¥åŠ›**: X, Yåº§æ¨™ã‚’ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã§å…¥åŠ›
  - **çŸ¢å°ã‚­ãƒ¼**: 1pxå˜ä½ã§å¾®èª¿æ•´
  - **Shift + çŸ¢å°ã‚­ãƒ¼**: 10pxå˜ä½ã§ç§»å‹•

**ä¸€æ™‚çš„èª¿æ•´ãƒ¢ãƒ¼ãƒ‰** (ç”Ÿæˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚):
- æ—¥ä»˜ã‚’æŒ‡å®šã—ãŸå¾Œã®æœ€çµ‚èª¿æ•´
- ãƒ—ãƒªã‚»ãƒƒãƒˆã«ã¯ä¿å­˜ã•ã‚Œãªã„
- åŒã˜æ“ä½œæ–¹æ³•ã‚’ä½¿ç”¨å¯èƒ½
- ã€Œæ’ä¹…çš„ã«ä¿å­˜ã€ãƒœã‚¿ãƒ³ã§ä¿å­˜å¯èƒ½

#### 2.5.2 é…ç½®è£œåŠ©æ©Ÿèƒ½

**ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º**:
- ON/OFFåˆ‡ã‚Šæ›¿ãˆå¯èƒ½
- ã‚°ãƒªãƒƒãƒ‰ã‚µã‚¤ã‚ºè¨­å®šï¼ˆ10px, 20px, 50pxç­‰ï¼‰
- ã‚°ãƒªãƒƒãƒ‰è‰²ãƒ»é€æ˜åº¦è¨­å®š

**ã‚¹ãƒŠãƒƒãƒ—æ©Ÿèƒ½**:
- ã‚°ãƒªãƒƒãƒ‰ã‚¹ãƒŠãƒƒãƒ—
- ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã‚¹ãƒŠãƒƒãƒ—ï¼ˆã‚¨ãƒƒã‚¸æ¤œå‡ºï¼‰
- ã‚­ãƒ£ãƒ³ãƒã‚¹ä¸­å¤®ã‚¹ãƒŠãƒƒãƒ—
- ON/OFFåˆ‡ã‚Šæ›¿ãˆå¯èƒ½

**ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**:
- æ°´å¹³ãƒ»å‚ç›´ã‚¬ã‚¤ãƒ‰ã‚’ä»»æ„ã®ä½ç½®ã«é…ç½®
- ãƒ«ãƒ¼ãƒ©ãƒ¼ã‹ã‚‰ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ä½œæˆ
- ã‚¬ã‚¤ãƒ‰ã¸ã®ã‚¹ãƒŠãƒƒãƒ—
- ã‚¬ã‚¤ãƒ‰ã®è¡¨ç¤º/éè¡¨ç¤º

**ãƒ«ãƒ¼ãƒ©ãƒ¼**:
- ä¸Šéƒ¨ãƒ»å·¦éƒ¨ã«ãƒ«ãƒ¼ãƒ©ãƒ¼è¡¨ç¤º
- ãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã®ç›®ç››ã‚Š
- ç¾åœ¨ã®ãƒã‚¦ã‚¹ä½ç½®ã‚’è¡¨ç¤º

**ã‚ºãƒ¼ãƒ æ©Ÿèƒ½**:
- ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«: 25%ã€œ400%ï¼ˆé€£ç¶šçš„ã«èª¿æ•´å¯èƒ½ï¼‰
- ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã‚¹ãƒ ãƒ¼ã‚ºã«ã‚ºãƒ¼ãƒ 
- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆCtrl/Cmd + +/-ï¼‰ã§æ®µéšçš„ã«ã‚ºãƒ¼ãƒ 
- ã‚ºãƒ¼ãƒ ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã§ä»»æ„ã®å€ç‡ã«è¨­å®š
- ãƒ—ãƒªã‚»ãƒƒãƒˆå€ç‡: 25%, 50%, 100%, 200%, 400%ï¼ˆãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§é©ç”¨ï¼‰
- ãƒ•ã‚£ãƒƒãƒˆè¡¨ç¤ºï¼ˆã‚­ãƒ£ãƒ³ãƒã‚¹å…¨ä½“ã‚’è¡¨ç¤ºï¼‰

---

### 2.6 ç”Ÿæˆãƒ•ãƒ­ãƒ¼

#### 2.6.1 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**:
1. ã‚¢ãƒ—ãƒªèµ·å‹•
2. ãƒ™ãƒ¼ã‚¹ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
3. è‡ªå‹•çš„ã«æ–°è¦ãƒ—ãƒªã‚»ãƒƒãƒˆãŒä½œæˆã•ã‚Œã‚‹ï¼ˆåå‰ã¯ãƒ™ãƒ¼ã‚¹ç”»åƒã®ãƒ•ã‚¡ã‚¤ãƒ«åï¼‰
4. ãƒ•ã‚©ãƒ³ãƒˆã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
5. ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ ãƒ»é…ç½®
   - ç”»åƒãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ  â†’ ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ é…ç½®
   - ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ  â†’ ãƒ†ã‚­ã‚¹ãƒˆè¨­å®š â†’ é…ç½®
6. å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®š
7. è‡ªå‹•ä¿å­˜ï¼ˆå¤‰æ›´ã®åº¦ã«IndexedDBã«ä¿å­˜ï¼‰
8. `Ctrl/Cmd + S` ã¾ãŸã¯ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€ã§ãƒ—ãƒªã‚»ãƒƒãƒˆåã‚’è¨­å®š

**æ—¥å¸¸ä½¿ç”¨**:
1. ã‚¢ãƒ—ãƒªèµ·å‹•ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒªã‚»ãƒƒãƒˆãŒè‡ªå‹•èª­ã¿è¾¼ã¿ï¼‰
2. ã€Œã‚µãƒ ãƒã‚¤ãƒ«ã‚’ç”Ÿæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ç”Ÿæˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤º
   - **å˜ä¸€æ—¥ä»˜ãƒ¢ãƒ¼ãƒ‰**:
     - æ—¥ä»˜é¸æŠï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼UIï¼‰
     - æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«åŸºã¥ã„ã¦è‡ªå‹•ç”Ÿæˆï¼ˆæ›œæ—¥å«ã‚€ï¼‰
     - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼‰
   - **è¤‡æ•°æ—¥ä»˜ãƒ¢ãƒ¼ãƒ‰**:
     - è¤‡æ•°ã®æ—¥ä»˜ã‚’é¸æŠï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼UIã§è¤‡æ•°é¸æŠï¼‰
     - ã¾ãŸã¯æ—¥ä»˜ç¯„å›²ã‚’æŒ‡å®šï¼ˆé–‹å§‹æ—¥ã€œçµ‚äº†æ—¥ï¼‰
     - é¸æŠã•ã‚ŒãŸæ—¥ä»˜ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
     - æœ€åˆã®æ—¥ä»˜ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
4. å¿…è¦ã«å¿œã˜ã¦ä¸€æ™‚çš„ãªä½ç½®èª¿æ•´
   - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸Šã§ãƒ‰ãƒ©ãƒƒã‚°
   - ã¾ãŸã¯æ•°å€¤å…¥åŠ›
5. ã€Œãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ãƒœã‚¿ãƒ³ã§PNGä¿å­˜
   - **å˜ä¸€æ—¥ä»˜**: 1ã¤ã®PNGãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
   - **è¤‡æ•°æ—¥ä»˜**: ZIPãƒ•ã‚¡ã‚¤ãƒ«ã§å…¨ã¦ã®æ—¥ä»˜ã®PNGã‚’ã¾ã¨ã‚ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
     - ãƒ•ã‚¡ã‚¤ãƒ«å: `thumbnail_YYYYMMDD.png` (å„æ—¥ä»˜)
     - ZIPãƒ•ã‚¡ã‚¤ãƒ«å: `thumbnails_YYYYMMDD-YYYYMMDD.zip`
6. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã¦ç·¨é›†ç”»é¢ã«æˆ»ã‚‹

#### 2.6.2 ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½

**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**:
- ç·¨é›†ä¸­ã€å¸¸ã«ã‚­ãƒ£ãƒ³ãƒã‚¹ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- å¤‰æ›´ãŒå³åº§ã«åæ˜ 
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é¸æŠçŠ¶æ…‹ã‚’è¦–è¦šçš„ã«è¡¨ç¤ºï¼ˆæ ç·šç­‰ï¼‰

**ç”Ÿæˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**:
- å®Ÿéš›ã®æ—¥ä»˜ã‚’é©ç”¨ã—ãŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- æœ€çµ‚å‡ºåŠ›ã¨åŒã˜è¦‹ãŸç›®
- ã‚ºãƒ¼ãƒ å¯èƒ½
- ä¸€æ™‚èª¿æ•´ã®åæ˜ 

---

### 2.7 ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼

#### 2.7.1 ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»»æ„ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã‚’è¨­å®šå¯èƒ½
- è¨­å®šUIï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰:
  - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§
  - ç¾åœ¨ã®ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰è¡¨ç¤º
  - ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ–°ã—ã„ã‚­ãƒ¼ã‚’å…¥åŠ›
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™ãƒœã‚¿ãƒ³
- è¨­å®šã¯localStorageã«ä¿å­˜

#### 2.7.2 ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ**:
- `Ctrl/Cmd + S`: ãƒ—ãƒªã‚»ãƒƒãƒˆåå¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã
- `Ctrl/Cmd + Shift + S`: åˆ¥åã§ä¿å­˜
- `Ctrl/Cmd + E`: ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- `Ctrl/Cmd + I`: ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- `Ctrl/Cmd + N`: æ–°è¦ãƒ—ãƒªã‚»ãƒƒãƒˆ

**ç·¨é›†æ“ä½œ**:
- `Ctrl/Cmd + Z`: å…ƒã«æˆ»ã™
- `Ctrl/Cmd + Shift + Z` or `Ctrl/Cmd + Y`: ã‚„ã‚Šç›´ã—
- `Ctrl/Cmd + C`: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ”ãƒ¼
- `Ctrl/Cmd + V`: ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒšãƒ¼ã‚¹ãƒˆ
- `Ctrl/Cmd + D`: ãƒ¬ã‚¤ãƒ¤ãƒ¼è¤‡è£½
- `Delete` or `Backspace`: é¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼å‰Šé™¤

**ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ**:
- `Ctrl/Cmd + ]`: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å‰é¢ã¸
- `Ctrl/Cmd + [`: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’èƒŒé¢ã¸
- `Ctrl/Cmd + Shift + ]`: æœ€å‰é¢ã¸
- `Ctrl/Cmd + Shift + [`: æœ€èƒŒé¢ã¸

**ç§»å‹•æ“ä½œ**:
- `çŸ¢å°ã‚­ãƒ¼`: ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•ï¼ˆ1pxï¼‰
- `Shift + çŸ¢å°ã‚­ãƒ¼`: ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•ï¼ˆ10pxï¼‰

**è¡¨ç¤ºæ“ä½œ**:
- `Ctrl/Cmd + ;`: ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
- `Ctrl/Cmd + '`: ã‚¬ã‚¤ãƒ‰è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
- `Ctrl/Cmd + R`: ãƒ«ãƒ¼ãƒ©ãƒ¼è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
- `Space + ãƒ‰ãƒ©ãƒƒã‚°`: ã‚­ãƒ£ãƒ³ãƒã‚¹ãƒ‘ãƒ³ï¼ˆç§»å‹•ï¼‰
- `Ctrl/Cmd + 0`: ã‚ºãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆ100%ï¼‰
- `Ctrl/Cmd + +`: ã‚ºãƒ¼ãƒ ã‚¤ãƒ³
- `Ctrl/Cmd + -`: ã‚ºãƒ¼ãƒ ã‚¢ã‚¦ãƒˆ

**ãã®ä»–**:
- `Ctrl/Cmd + G`: ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã
- `Tab`: æ¬¡ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é¸æŠ
- `Shift + Tab`: å‰ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é¸æŠ

---

## 3. éæ©Ÿèƒ½è¦ä»¶

### 3.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- **åˆå›ãƒ­ãƒ¼ãƒ‰**: 3ç§’ä»¥å†…ï¼ˆService Worker ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¾Œã¯1ç§’ä»¥å†…ï¼‰
- **ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œãƒ¬ã‚¹ãƒãƒ³ã‚¹**: 100msä»¥å†…
- **ã‚­ãƒ£ãƒ³ãƒã‚¹å†æç”»**: 60fpsç¶­æŒ
- **PNGç”Ÿæˆæ™‚é–“**: 
  - 1920x1080: 3ç§’ä»¥å†…
  - 3840x2160 (4K): 10ç§’ä»¥å†…
- **ãƒ—ãƒªã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿**: 1ç§’ä»¥å†…
- **ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜**: 500msä»¥å†…

### 3.2 ãƒ‡ãƒ¼ã‚¿ä¿å­˜

**IndexedDB ã‚¹ã‚­ãƒ¼ãƒ**:

```typescript
// ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å: hizuke-thumb
// ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1

// ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆã‚¢: presets
interface PresetRecord {
  id: string;                  // UUID
  name: string;                // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¿å­˜æ™‚ã«æŒ‡å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ãƒ™ãƒ¼ã‚¹ç”»åƒåï¼‰
  isDefault: boolean;
  createdAt: number;           // timestamp
  updatedAt: number;
  canvas: {
    width: number;
    height: number;
    baseImageId: string;       // â†’ images ã‚¹ãƒˆã‚¢ã¸ã®å‚ç…§
  };
  layers: Layer[];             // ä¸Šè¨˜å®šç¾©å‚ç…§
  thumbnailId: string;         // â†’ images ã‚¹ãƒˆã‚¢ã¸ã®å‚ç…§
}

// ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆã‚¢: images
interface ImageRecord {
  id: string;                  // UUID
  name: string;
  mimeType: string;
  data: Blob;                  // ç”»åƒãƒã‚¤ãƒŠãƒª
  createdAt: number;
}

// ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆã‚¢: fonts
interface FontRecord {
  id: string;                  // UUID
  name: string;
  family: string;              // ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ãƒŸãƒªãƒ¼å
  data: Blob;                  // ãƒ•ã‚©ãƒ³ãƒˆãƒã‚¤ãƒŠãƒª
  createdAt: number;
}

// ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆã‚¢: settings
interface SettingsRecord {
  key: string;                 // è¨­å®šã‚­ãƒ¼
  value: any;                  // è¨­å®šå€¤
}
```

**å®¹é‡åˆ¶é™**:
- ãƒ—ãƒªã‚»ãƒƒãƒˆ1ã¤ã‚ãŸã‚Š: 50MBä»¥å†…ã‚’æ¨å¥¨
- ç”»åƒ1æšã‚ãŸã‚Š: 10MBä»¥å†…ã‚’æ¨å¥¨
- ãƒ•ã‚©ãƒ³ãƒˆ1ã¤ã‚ãŸã‚Š: 5MBä»¥å†…ã‚’æ¨å¥¨
- åˆè¨ˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: ãƒ–ãƒ©ã‚¦ã‚¶ã®åˆ¶é™ã«ä¾å­˜ï¼ˆé€šå¸¸æ•°GBï¼‰

**ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**:
- ãƒ—ãƒªã‚»ãƒƒãƒˆå‰Šé™¤æ™‚ã€ä½¿ç”¨ã—ã¦ã„ãªã„ç”»åƒãƒ»ãƒ•ã‚©ãƒ³ãƒˆã‚’è‡ªå‹•å‰Šé™¤
- å‚ç…§ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†

### 3.3 ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ

**Service Worker æˆ¦ç•¥**:

```typescript
// Cache-First æˆ¦ç•¥
self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request).then((response) => {
      return response || fetch(event.request);
    })
  );
});
```

**ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾è±¡**:
- HTML, CSS, JavaScriptï¼ˆå…¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ï¼‰
- ã‚¢ã‚¤ã‚³ãƒ³ã€ãƒ­ã‚´ç­‰ã®é™çš„ã‚¢ã‚»ãƒƒãƒˆ
- Webãƒ•ã‚©ãƒ³ãƒˆï¼ˆUIç”¨ï¼‰

**ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾è±¡å¤–**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒãƒ»ãƒ•ã‚©ãƒ³ãƒˆï¼ˆIndexedDBã«ä¿å­˜ï¼‰
- å¤–éƒ¨APIï¼ˆä½¿ç”¨ã—ãªã„ï¼‰

**æ›´æ–°æˆ¦ç•¥**:
- æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚ã‚Œã°ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- ã€Œæ›´æ–°ãŒåˆ©ç”¨å¯èƒ½ã§ã™ã€é€šçŸ¥ã‚’è¡¨ç¤º
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åˆ‡ã‚Šæ›¿ãˆ

### 3.4 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼

- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¯å…¨ã¦ãƒ­ãƒ¼ã‚«ãƒ«ï¼ˆIndexedDBï¼‰ã«ä¿å­˜
- âœ… ã‚µãƒ¼ãƒãƒ¼ã¸ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡ãªã—
- âœ… å¤–éƒ¨é€šä¿¡ãªã—ï¼ˆå®Œå…¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼‰
- âœ… ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ãªã—
- âœ… ã‚¯ãƒƒã‚­ãƒ¼ä½¿ç”¨ãªã—
- âœ… HTTPSå¿…é ˆï¼ˆService Workerè¦ä»¶ï¼‰

---

## 4. UI/UXè¦ä»¶

### 4.1 ç”»é¢æ§‹æˆ

**ãƒ¡ã‚¤ãƒ³ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Header (ãƒ„ãƒ¼ãƒ«ãƒãƒ¼)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚                           â”‚
â”‚   Canvas Editor             â”‚  Properties Panel (ä¸Šéƒ¨)  â”‚
â”‚   (ä¸­å¤®ãƒ»æœ€å¤§ã‚¨ãƒªã‚¢)         â”‚                           â”‚
â”‚                             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                             â”‚  â”‚ é¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®      â”‚ â”‚
â”‚                             â”‚  â”‚ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£          â”‚ â”‚
â”‚                             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                           â”‚
â”‚                             â”‚  Layer Panel (ä¸‹éƒ¨)       â”‚
â”‚   Flexible                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                             â”‚  â”‚ ãƒ¬ã‚¤ãƒ¤ãƒ¼ä¸€è¦§        â”‚ â”‚
â”‚                             â”‚  â”‚                     â”‚ â”‚
â”‚                             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                           â”‚
â”‚                             â”‚  320px                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Header (ãƒ„ãƒ¼ãƒ«ãƒãƒ¼)**:
- å·¦: ã‚¢ãƒ—ãƒªåï¼ˆã²ã¥ã‘ã‚µãƒ ãƒï¼‰ãƒ»ãƒ­ã‚´
- ä¸­å¤®: ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³
- å³: 
  - ä¿å­˜ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆè‡ªå‹•ä¿å­˜ä¸­/ä¿å­˜æ¸ˆã¿ï¼‰
  - ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€ãƒœã‚¿ãƒ³
  - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³
  - è¨­å®šãƒœã‚¿ãƒ³
  - ã€Œã‚µãƒ ãƒã‚¤ãƒ«ã‚’ç”Ÿæˆã€ãƒœã‚¿ãƒ³ï¼ˆå¼·èª¿ï¼‰

**Canvas Editor (ä¸­å¤®ã‚¨ãƒªã‚¢)**:
- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ï¼ˆä¸Šéƒ¨ï¼‰:
  - ã‚ºãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
  - ã‚°ãƒªãƒƒãƒ‰ãƒ»ã‚¬ã‚¤ãƒ‰ãƒ»ãƒ«ãƒ¼ãƒ©ãƒ¼åˆ‡ã‚Šæ›¿ãˆ
  - ã‚¹ãƒŠãƒƒãƒ—åˆ‡ã‚Šæ›¿ãˆ
  - å…ƒã«æˆ»ã™/ã‚„ã‚Šç›´ã—
- ã‚­ãƒ£ãƒ³ãƒã‚¹è¡¨ç¤ºã‚¨ãƒªã‚¢:
  - ãƒã‚§ãƒƒã‚«ãƒ¼ãƒœãƒ¼ãƒ‰èƒŒæ™¯ï¼ˆé€æ˜éƒ¨åˆ†ã®è¡¨ç¤ºï¼‰
  - ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡¨ç¤º
  - é¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ï¼ˆä¸‹éƒ¨ï¼‰:
  - ãƒã‚¦ã‚¹åº§æ¨™è¡¨ç¤º
  - ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºè¡¨ç¤º
  - ã‚ºãƒ¼ãƒ ç‡è¡¨ç¤º

**å³ã‚µã‚¤ãƒ‰ãƒãƒ¼**:
- æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½
- ä¸Šéƒ¨: **Properties Panel**ï¼ˆé¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼‰
- ä¸‹éƒ¨: **Layer Panel**ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ä¸€è¦§ï¼‰

**Properties Panel (å³ä¸Š)**:
- é¸æŠãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤º
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦å†…å®¹ãŒå¤‰ã‚ã‚‹:
  - ç”»åƒãƒ¬ã‚¤ãƒ¤ãƒ¼: ä½ç½®ã€ã‚µã‚¤ã‚ºã€ä¸é€æ˜åº¦
  - ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼: ä½ç½®ã€ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ã€æ›¸å¼è¨­å®š
- ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³å½¢å¼ï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³æ¯ã«æŠ˜ã‚ŠãŸãŸã¿ï¼‰

**Layer Panel (å³ä¸‹)**:
- ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ ãƒœã‚¿ãƒ³ï¼ˆç”»åƒãƒ»ãƒ†ã‚­ã‚¹ãƒˆï¼‰
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒªã‚¹ãƒˆï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰
- å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ :
  - ã‚µãƒ ãƒã‚¤ãƒ«
  - ãƒ¬ã‚¤ãƒ¤ãƒ¼å
  - è¡¨ç¤º/éè¡¨ç¤ºãƒˆã‚°ãƒ«
  - ãƒ­ãƒƒã‚¯ãƒˆã‚°ãƒ«

### 4.2 ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠç”»é¢

ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°:

```svelte
<PresetSelector>
  <div class="preset-grid">
    {#each presets as preset}
      <PresetCard
        {preset}
        onselect={() => loadPreset(preset.id)}
        ondelete={() => deletePreset(preset.id)}
        onduplicate={() => duplicatePreset(preset.id)}
      />
    {/each}
    <NewPresetCard onclick={createNewPreset} />
  </div>
</PresetSelector>
```

å„ãƒ—ãƒªã‚»ãƒƒãƒˆã‚«ãƒ¼ãƒ‰:
- ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒï¼ˆ300x200pxç¨‹åº¦ï¼‰
- ãƒ—ãƒªã‚»ãƒƒãƒˆå
- æœ€çµ‚æ›´æ–°æ—¥æ™‚
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒƒã‚¸ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- ãƒ›ãƒãƒ¼æ™‚ã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³è¡¨ç¤º:
  - é¸æŠ
  - ç·¨é›†ï¼ˆåå‰å¤‰æ›´ï¼‰
  - è¤‡è£½
  - å‰Šé™¤
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«è¨­å®š

### 4.3 ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜ãƒ€ã‚¤ã‚¢ãƒ­ã‚°

`Ctrl/Cmd + S` ã¾ãŸã¯ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€ãƒœã‚¿ãƒ³ã§è¡¨ç¤º:

```svelte
<PresetSaveDialog>
  <h2>ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’ä¿å­˜</h2>
  <label>
    ãƒ—ãƒªã‚»ãƒƒãƒˆå:
    <input type="text" bind:value={presetName} placeholder="ä¾‹: é…ä¿¡ã‚µãƒ ãƒã‚¤ãƒ«" />
  </label>
  <div class="actions">
    <button onclick={save}>ä¿å­˜</button>
    <button onclick={cancel}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
  </div>
</PresetSaveDialog>
```

### 4.4 ç”Ÿæˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢

ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°:

```svelte
<GenerationDialog>
  <div class="dialog-layout">
    <div class="preview-area">
      <CanvasPreview {generatedImage} />
      <!-- ä¸€æ™‚èª¿æ•´ç”¨ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
      
      <!-- è¤‡æ•°æ—¥ä»˜ã®å ´åˆ: æ—¥ä»˜ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
      {#if selectedDates.length > 1}
        <div class="date-navigation">
          <button onclick={previousDate}>â† å‰ã®æ—¥ä»˜</button>
          <span>{currentDateIndex + 1} / {selectedDates.length}</span>
          <button onclick={nextDate}>æ¬¡ã®æ—¥ä»˜ â†’</button>
        </div>
      {/if}
    </div>
    
    <div class="controls-area">
      <!-- æ—¥ä»˜é¸æŠãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ -->
      <div class="mode-toggle">
        <button class:active={mode === 'single'} onclick={() => mode = 'single'}>
          å˜ä¸€æ—¥ä»˜
        </button>
        <button class:active={mode === 'multiple'} onclick={() => mode = 'multiple'}>
          è¤‡æ•°æ—¥ä»˜
        </button>
      </div>
      
      <!-- æ—¥ä»˜é¸æŠUI -->
      {#if mode === 'single'}
        <DatePicker bind:selectedDate />
      {:else}
        <DateRangePicker bind:selectedDates />
        <div class="selected-dates-list">
          {#each selectedDates as date}
            <span class="date-chip">
              {formatDate(date, 'yyyy/MM/dd')}
              <button onclick={() => removeDate(date)}>Ã—</button>
            </span>
          {/each}
        </div>
      {/if}
      
      <!-- å‹•çš„ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä¸€è¦§ -->
      {#each dateTextLayers as layer}
        <div class="layer-preview">
          <span>{layer.name}</span>
          <span class="preview-text">
            {generateText(layer, currentPreviewDate)}
          </span>
        </div>
      {/each}
      
      <div class="actions">
        <button onclick={download}>
          {selectedDates.length > 1 ? `${selectedDates.length}ä»¶ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰` : 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰'}
        </button>
        <button variant="secondary" onclick={saveAdjustments}>
          èª¿æ•´ã‚’æ’ä¹…çš„ã«ä¿å­˜
        </button>
        <button variant="ghost" onclick={cancel}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>
    </div>
  </div>
</GenerationDialog>
```

### 4.5 ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ 

- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
- ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã«è¿½å¾“ã‚ªãƒ—ã‚·ãƒ§ãƒ³

**ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆä¾‹ï¼ˆãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼‰**:

```css
:root {
  --bg-primary: #1a1a1a;
  --bg-secondary: #2a2a2a;
  --bg-tertiary: #3a3a3a;
  --text-primary: #ffffff;
  --text-secondary: #b0b0b0;
  --border: #404040;
  --accent: #3b82f6;
  --accent-hover: #2563eb;
  --danger: #ef4444;
  --success: #10b981;
}
```

### 4.6 ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

- **ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—å„ªå…ˆè¨­è¨ˆ** (1024pxä»¥ä¸Š)
- ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆå¯¾å¿œ (768px-1023px):
  - ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ã«
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ‘ãƒãƒ«ã‚’ãƒ¢ãƒ¼ãƒ€ãƒ«åŒ–
- ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³: å¯¾å¿œã—ãªã„ï¼ˆç”»é¢ã‚µã‚¤ã‚ºä¸è¶³ï¼‰
  - 768pxæœªæº€ã§ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã¯è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

---

## 5. å°†æ¥ã®æ‹¡å¼µæ€§ã¸ã®é…æ…®

### 5.1 Svelte 5 Runes ã‚’æ´»ç”¨ã—ãŸè¨­è¨ˆ

**çŠ¶æ…‹ç®¡ç†ä¾‹**:

```typescript
// lib/state/layers.svelte.ts
import type { Layer } from '$lib/types';

class LayerState {
  layers = $state<Layer[]>([]);
  selectedLayerId = $state<string | null>(null);
  
  // æ´¾ç”ŸçŠ¶æ…‹ï¼ˆ$derived ãƒ«ãƒ¼ãƒ³ä½¿ç”¨ï¼‰
  selectedLayer = $derived(
    this.layers.find(l => l.id === this.selectedLayerId) ?? null
  );
  
  visibleLayers = $derived(
    this.layers.filter(l => l.visible)
  );
  
  // ãƒ¡ã‚½ãƒƒãƒ‰
  addLayer(layer: Layer) {
    this.layers = [...this.layers, layer];
  }
  
  removeLayer(id: string) {
    this.layers = this.layers.filter(l => l.id !== id);
  }
  
  moveLayer(id: string, delta: { x: number; y: number }) {
    this.layers = this.layers.map(l =>
      l.id === id
        ? { ...l, position: { x: l.position.x + delta.x, y: l.position.y + delta.y } }
        : l
    );
  }
}

export const layerState = new LayerState();
```

**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã®ä½¿ç”¨**:

```svelte
<script lang="ts">
  import { layerState } from '$lib/state/layers.svelte';
  
  // Runes ã§è‡ªå‹•çš„ã«ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–
  const { layers, selectedLayer } = layerState;
</script>

<div>
  <p>é¸æŠä¸­: {selectedLayer?.name ?? 'ãªã—'}</p>
  
  {#each layers as layer}
    <div>{layer.name}</div>
  {/each}
</div>
```

### 5.2 ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ã®æ‹¡å¼µè¨­è¨ˆ

```typescript
// lib/types/layer.ts

// é™çš„ãƒ†ã‚­ã‚¹ãƒˆ
export type StaticTextContent = {
  type: 'static';
  value: string;
};

// æ—¥ä»˜ãƒ†ã‚­ã‚¹ãƒˆ
export type DateTextContent = {
  type: 'date';
  format: string;
  locale: 'ja' | 'en';
};

// å°†æ¥è¿½åŠ ã•ã‚Œã‚‹å ´åˆã®ä¾‹
/*
export type CustomTextContent = {
  type: 'custom';
  template: string;
  variables: Record<string, any>;
};
*/

export type TextContent = StaticTextContent | DateTextContent; // | CustomTextContent;

// ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã®å‹å®‰å…¨ãªå®Ÿè£…
export const textRenderers = {
  'static': (content: StaticTextContent) => content.value,
  'date': (content: DateTextContent, context: { date: Date }) => {
    return formatDate(context.date, content.format, content.locale);
  },
  // å°†æ¥è¿½åŠ :
  // 'custom': (content: CustomTextContent, context) => { ... }
} as const;

// æ±ç”¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°é–¢æ•°ï¼ˆå‹å®‰å…¨ï¼‰
export function renderTextContent(content: TextContent, context: { date: Date }): string {
  switch (content.type) {
    case 'static':
      return textRenderers.static(content);
    case 'date':
      return textRenderers.date(content, context);
    // å°†æ¥è¿½åŠ æ™‚ã¯ã“ã“ã«ã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ 
  }
}
```

### 5.3 Canvas Engine ã®æŠ½è±¡åŒ–

```typescript
// lib/canvas/CanvasEngine.ts

export class CanvasEngine {
  private ctx: CanvasRenderingContext2D;
  
  constructor(canvas: HTMLCanvasElement) {
    this.ctx = canvas.getContext('2d')!;
  }
  
  // ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ éä¾å­˜ã®æç”»API
  render(layers: Layer[]): void {
    this.clear();
    
    // Z-indexã§ã‚½ãƒ¼ãƒˆ
    const sortedLayers = [...layers].sort((a, b) => a.zIndex - b.zIndex);
    
    for (const layer of sortedLayers) {
      if (!layer.visible) continue;
      
      if (layer.type === 'image') {
        this.renderImage(layer as ImageLayer);
      } else if (layer.type === 'text') {
        this.renderText(layer as TextLayer);
      }
    }
  }
  
  private renderImage(layer: ImageLayer): void {
    // ç”»åƒæç”»ãƒ­ã‚¸ãƒƒã‚¯
  }
  
  private renderText(layer: TextLayer): void {
    // ãƒ†ã‚­ã‚¹ãƒˆæç”»ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã€ã‚·ãƒ£ãƒ‰ã‚¦å«ã‚€ï¼‰
  }
  
  private clear(): void {
    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);
  }
}
```

### 5.4 ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œã®æº–å‚™

**ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆå¯¾å¿œã®æŠ½è±¡åŒ–**:

```typescript
// lib/utils/input.ts

export interface PointerEvent {
  x: number;
  y: number;
  type: 'start' | 'move' | 'end';
}

export class InputHandler {
  handlePointerDown(e: MouseEvent | TouchEvent): PointerEvent {
    const point = 'touches' in e ? e.touches[0] : e;
    return {
      x: point.clientX,
      y: point.clientY,
      type: 'start'
    };
  }
  
  handlePointerMove(e: MouseEvent | TouchEvent): PointerEvent {
    const point = 'touches' in e ? e.touches[0] : e;
    return {
      x: point.clientX,
      y: point.clientY,
      type: 'move'
    };
  }
  
  handlePointerUp(e: MouseEvent | TouchEvent): PointerEvent {
    const point = 'changedTouches' in e ? e.changedTouches[0] : e;
    return {
      x: point.clientX,
      y: point.clientY,
      type: 'end'
    };
  }
}
```

---

## 6. é–‹ç™ºãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1: ã‚³ã‚¢æ©Ÿèƒ½ï¼ˆMVPï¼‰ âœ… å®Œäº†

- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¦ä»¶å®šç¾©
- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆVite + Svelte 5 + TypeScript + Bunï¼‰
- [x] åŸºæœ¬UIæ§‹ç¯‰ï¼ˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€å³ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ãƒ˜ãƒƒãƒ€ãƒ¼ï¼‰
- [x] IndexedDB å®Ÿè£…ï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆã€ç”»åƒã€ãƒ•ã‚©ãƒ³ãƒˆï¼‰
- [x] Canvas Engine å®Ÿè£…ï¼ˆåŸºæœ¬æç”»ï¼‰
- [x] ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†ï¼ˆè¿½åŠ ã€å‰Šé™¤ã€ä¸¦ã³æ›¿ãˆï¼‰
- [x] ç”»åƒãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€è¡¨ç¤ºï¼‰
- [x] ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆé™çš„ãƒ†ã‚­ã‚¹ãƒˆã€åŸºæœ¬æ›¸å¼ï¼‰
- [x] ãƒ—ãƒªã‚»ãƒƒãƒˆä¿å­˜ãƒ»èª­ã¿è¾¼ã¿ï¼ˆè‡ªå‹•ä¿å­˜ + åå‰ä»˜ã‘ä¿å­˜ï¼‰
- [x] PNG ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

### Phase 2: ãƒ†ã‚­ã‚¹ãƒˆæ©Ÿèƒ½ ğŸš§ é€²è¡Œä¸­

- [x] ãƒ•ã‚©ãƒ³ãƒˆç®¡ç†ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€IndexedDBä¿å­˜ï¼‰
- [x] ãƒ†ã‚­ã‚¹ãƒˆè©³ç´°æ›¸å¼ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã€ã‚·ãƒ£ãƒ‰ã‚¦ç­‰ï¼‰
- [x] å‹•çš„ãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ—¥ä»˜ï¼‰
- [x] æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆ + ã‚«ã‚¹ã‚¿ãƒ  + è¨€èªé¸æŠï¼‰
- [ ] è¤‡æ•°æ—¥ä»˜é¸æŠæ©Ÿèƒ½
- [ ] è¤‡æ•°æ—¥ä»˜ã®ä¸€æ‹¬ç”Ÿæˆãƒ»ZIPå‡ºåŠ›

### Phase 3: UXæ”¹å–„ ğŸš§ é€²è¡Œä¸­

- [x] ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•
- [ ] å…ƒã«æˆ»ã™/ã‚„ã‚Šç›´ã—
- [x] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆåŸºæœ¬å®Ÿè£…ï¼šçŸ¢å°ã‚­ãƒ¼ã€Delete/Backspaceï¼‰
- [x] ã‚°ãƒªãƒƒãƒ‰ãƒ»ã‚¬ã‚¤ãƒ‰ãƒ»ãƒ«ãƒ¼ãƒ©ãƒ¼
- [x] ã‚ºãƒ¼ãƒ æ©Ÿèƒ½
- [ ] ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºï¼‰

### Phase 4: é«˜åº¦ãªæ©Ÿèƒ½ ğŸš§ é€²è¡Œä¸­

- [x] ãƒ—ãƒªã‚»ãƒƒãƒˆé¸æŠUI
- [x] ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆJSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå®Ÿè£…æ¸ˆã¿ï¼‰
- [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆé–‹ç™ºä¸­ï¼‰
- [x] ç”Ÿæˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
- [ ] ä¸€æ™‚çš„èª¿æ•´ãƒ¢ãƒ¼ãƒ‰
- [ ] ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- [ ] ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰/ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼ˆç¾åœ¨ã¯ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ã¿ï¼‰

### Phase 5: æœ€é©åŒ– ğŸš§ é€²è¡Œä¸­

- [x] Service Worker (PWAå¯¾å¿œ)
- [ ] Web Worker (ç”»åƒå‡¦ç†)
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
- [ ] ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆVitestï¼‰

### Phase 6ï¼ˆå°†æ¥ï¼‰: æ‹¡å¼µæ©Ÿèƒ½

- [ ] æ–°ã—ã„ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—è¿½åŠ 
- [ ] ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
- [ ] ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå›è»¢ã€ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰
- [ ] ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œï¼ˆç°¡æ˜“ç‰ˆï¼‰

---

## 7. æŠ€è¡“ä»•æ§˜è©³ç´°

### 7.1 package.json

```json
{
  "name": "hizuke-thumb",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "check": "svelte-check --tsconfig ./tsconfig.json",
    "test": "vitest",
    "test:ui": "vitest --ui"
  },
  "dependencies": {
    "dexie": "^4.0.0",
    "date-fns": "^3.6.0"
  },
  "devDependencies": {
    "@sveltejs/vite-plugin-svelte": "^4.0.0",
    "@tsconfig/svelte": "^5.0.0",
    "autoprefixer": "^10.4.0",
    "postcss": "^8.4.0",
    "svelte": "^5.0.0",
    "svelte-check": "^4.0.0",
    "tailwindcss": "^4.0.0",
    "tslib": "^2.6.0",
    "typescript": "^5.5.0",
    "vite": "^7.0.0",
    "vite-plugin-pwa": "^1.0.0",
    "vitest": "^4.0.0"
  }
}
```

### 7.2 ä¸»è¦è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

**vite.config.ts**:

```typescript
import { defineConfig } from 'vite';
import { svelte } from '@sveltejs/vite-plugin-svelte';
import { VitePWA } from 'vite-plugin-pwa';

export default defineConfig({
  plugins: [
    svelte(),
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'robots.txt', 'icons/*.png'],
      manifest: {
        name: 'ã²ã¥ã‘ã‚µãƒ ãƒ',
        short_name: 'ã²ã¥ã‘ã‚µãƒ ãƒ',
        description: 'é…ä¿¡ãƒ»å‹•ç”»ã‚µãƒ ãƒã‚¤ãƒ«ä½œæˆæ”¯æ´ãƒ„ãƒ¼ãƒ«',
        theme_color: '#1a1a1a',
        icons: [
          {
            src: 'icons/icon-192.png',
            sizes: '192x192',
            type: 'image/png'
          },
          {
            src: 'icons/icon-512.png',
            sizes: '512x512',
            type: 'image/png'
          }
        ]
      }
    })
  ],
  resolve: {
    alias: {
      '$lib': '/src/lib',
      '$components': '/src/components'
    }
  }
});
```

**svelte.config.js**:

```javascript
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte';

export default {
  preprocess: vitePreprocess(),
  compilerOptions: {
    runes: true  // Svelte 5 Runes ã‚’æœ‰åŠ¹åŒ–
  }
};
```

**tailwind.config.js**:

```javascript
export default {
  content: ['./src/**/*.{html,js,svelte,ts}'],
  theme: {
    extend: {
      colors: {
        'bg-primary': '#1a1a1a',
        'bg-secondary': '#2a2a2a',
        'bg-tertiary': '#3a3a3a',
        'text-primary': '#ffffff',
        'text-secondary': '#b0b0b0',
        'accent': '#3b82f6',
      }
    }
  },
  plugins: []
};
```

**bunfig.toml** (ã‚ªãƒ—ã‚·ãƒ§ãƒ³):

```toml
[install]
# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«è¨­å®š
cache = true
registry = "https://registry.npmjs.org/"
frozenLockfile = false

[test]
# Vitestç”¨ï¼ˆBunã®ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã¯ä½¿ç”¨ã—ãªã„ï¼‰
preload = []
```

**tsconfig.json**:

```json
{
  "extends": "@tsconfig/svelte/tsconfig.json",
  "compilerOptions": {
    "target": "ESNext",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "lib": ["ESNext", "DOM", "DOM.Iterable"],
    "types": ["vite/client"],
    "resolveJsonModule": true,
    "allowJs": true,
    "checkJs": true,
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "paths": {
      "$lib": ["./src/lib"],
      "$lib/*": ["./src/lib/*"],
      "$components": ["./src/components"],
      "$components/*": ["./src/components/*"]
    }
  },
  "include": ["src/**/*.d.ts", "src/**/*.ts", "src/**/*.js", "src/**/*.svelte"],
  "exclude": ["node_modules"]
}
```

### 7.3 é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

```bash
# åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
bun install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
bun dev

# å‹ãƒã‚§ãƒƒã‚¯
bun run check

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆVitestï¼‰
bun test

# ãƒ†ã‚¹ãƒˆUI
bun test:ui

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
bun build

# ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
bun preview
```

### 7.4 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

```bash
# 1. Bunã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆã¾ã ã®å ´åˆï¼‰
curl -fsSL https://bun.sh/install | bash

# 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
mkdir hizuke-thumb
cd hizuke-thumb

# 3. package.jsonä½œæˆï¼ˆä¸Šè¨˜ã®å†…å®¹ã§ä½œæˆï¼‰

# 4. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
bun install

# 5. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
# - vite.config.ts
# - svelte.config.js
# - tailwind.config.js
# - tsconfig.json

# 6. é–‹ç™ºé–‹å§‹
bun dev
```

### 7.5 CI/CDè¨­å®šï¼ˆGitHub Actionsï¼‰

```yaml
# .github/workflows/ci.yml
name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Bun
      uses: oven-sh/setup-bun@v1
      with:
        bun-version: latest
    
    - name: Install dependencies
      run: bun install --frozen-lockfile
    
    - name: Run type check
      run: bun run check
    
    - name: Run tests (Vitest)
      run: bun test
    
    - name: Build
      run: bun run build
    
    - name: Upload build artifacts
      uses: actions/upload-artifact@v3
      with:
        name: dist
        path: dist/
```

### 7.6 .gitignore

```gitignore
# Bun
node_modules
bun.lockb

# Build output
dist/
.svelte-kit/

# Environment
.env
.env.*

# IDE
.vscode/
.idea/

# OS
.DS_Store
Thumbs.db

# Test
coverage/

# Logs
*.log
```

---

## ä»˜éŒ²: é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ

### A. IndexedDBå®Ÿè£…ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

```typescript
// lib/storage/indexeddb.ts
import Dexie, { type EntityTable } from 'dexie';
import type { PresetRecord, ImageRecord, FontRecord, SettingsRecord } from '$lib/types';

const DB_NAME = 'hizuke-thumb';
const DB_VERSION = 1;

// ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å‹å®šç¾©
export class HizukeThumbDB extends Dexie {
  presets!: EntityTable<PresetRecord, 'id'>;
  images!: EntityTable<ImageRecord, 'id'>;
  fonts!: EntityTable<FontRecord, 'id'>;
  settings!: EntityTable<SettingsRecord, 'key'>;

  constructor() {
    super(DB_NAME);
    
    this.version(DB_VERSION).stores({
      presets: 'id, name, isDefault, updatedAt',
      images: 'id, name, createdAt',
      fonts: 'id, name, family, createdAt',
      settings: 'key'
    });
  }
}

// ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
export const db = new HizukeThumbDB();

// ä½¿ç”¨ä¾‹
export async function savePreset(preset: PresetRecord): Promise<string> {
  return await db.presets.put(preset);
}

export async function getPreset(id: string): Promise<PresetRecord | undefined> {
  return await db.presets.get(id);
}

export async function getAllPresets(): Promise<PresetRecord[]> {
  return await db.presets.orderBy('updatedAt').reverse().toArray();
}

export async function deletePreset(id: string): Promise<void> {
  await db.presets.delete(id);
}
```

### B. Canvasæç”»ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

```typescript
// lib/canvas/CanvasEngine.ts
export class CanvasEngine {
  private offscreenCanvas: OffscreenCanvas | null = null;
  
  // ã‚ªãƒ•ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½¿ã£ãŸæç”»
  async renderOffscreen(layers: Layer[]): Promise<Blob> {
    if (!this.offscreenCanvas) {
      this.offscreenCanvas = new OffscreenCanvas(
        this.ctx.canvas.width,
        this.ctx.canvas.height
      );
    }
    
    const offscreenCtx = this.offscreenCanvas.getContext('2d')!;
    
    // æç”»å‡¦ç†
    this.renderToContext(offscreenCtx, layers);
    
    return await this.offscreenCanvas.convertToBlob({ type: 'image/png' });
  }
}
```

### C. Svelte 5 Runesã®åŠ¹æœçš„ãªä½¿ç”¨

```typescript
// lib/state/canvas.svelte.ts
class CanvasState {
  // çŠ¶æ…‹
  zoom = $state(1.0);
  panOffset = $state({ x: 0, y: 0 });
  showGrid = $state(false);
  showGuides = $state(true);
  showRuler = $state(true);
  
  // æ´¾ç”ŸçŠ¶æ…‹ï¼ˆ$derived ãƒ«ãƒ¼ãƒ³ä½¿ç”¨ï¼‰
  viewTransform = $derived({
    scale: this.zoom,
    translateX: this.panOffset.x,
    translateY: this.panOffset.y
  });
  
  // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  setZoom(zoom: number) {
    this.zoom = Math.max(0.25, Math.min(4.0, zoom));
  }
  
  resetView() {
    this.zoom = 1.0;
    this.panOffset = { x: 0, y: 0 };
  }
}

export const canvasState = new CanvasState();
```

---

## çµ‚ã‚ã‚Šã«

ã“ã®è¦ä»¶å®šç¾©æ›¸ã¯ã€ã€Œã²ã¥ã‘ã‚µãƒ ãƒ (hizuke-thumb)ã€ã®å®Œå…¨ãªä»•æ§˜ã‚’è¨˜è¿°ã—ã¦ã„ã¾ã™ã€‚é–‹ç™ºã‚’é–‹å§‹ã™ã‚‹éš›ã¯ã€Phase 1ã‹ã‚‰é †ç•ªã«å®Ÿè£…ã—ã¦ã„ãã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

è³ªå•ã‚„ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ã€å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
